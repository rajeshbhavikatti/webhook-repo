<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{{Title}}</title>
  </head>
  <body>
    <div id="main">
    <h1>Action Repo Details</h1>
    {%for task in tasks%}
    <h5>
      <!-- Statement as per the PDF -->
      {%if task.action == "pushed"%} <!-- For PUSH action-->
        "{{task.author}}" pushed to {{task.to_branch}} on {{task.timestamp}}
      {%elif task.action =="reopened"%} <!-- For PULl_REQUEST action when a closed request is reopened -->
        "{{task.author}}" submitted a pull request from {{task.from_branch}} to {{task.to_branch}} on {{task.timestamp}}
      {%elif task.action =="opened"%}  <!-- For PULL_REQUEST action when new request is opened-->
        "{{task.author}}" submitted a pull request from {{task.from_branch}} to {{task.to_branch}} on {{task.timestamp}}
      {%elif task.action =="synchronize"%}  <!-- For synchronize action-->
        "{{task.author}}" resolved confit between {{task.from_branch}} and {{task.to_branch}} on {{task.timestamp}}
      {%elif task.action =="closed" and task.merge=="True" %} <!-- For MERGE action-->
        "{{task.author}}" merged branch {{task.from_branch}} to {{task.to_branch}} on {{task.timestamp}}
      {%elif task.action =="closed"%}  <!-- For PULL_REQUEST action when a request is closed-->
        "{{task.author}}" closed a pull request from {{task.from_branch}} to {{task.to_branch}} on {{task.timestamp}}
      {%endif%}
    </h5>
    {%endfor%}

  </div>
    <script>
      let url = "https://supreme-alabaster-mandrill.glitch.me/webhook/ui/update"
      setInterval(function(){
        fetch(url)
    .then(response => response.json())  
    .then(data => {console.log("updating");
                  let optionalHTML= data.task;
                   document.getElementById("main").innerHTML= optionalHTML;
                  });
      },15000);
      
    </script>
    
    
  </body>
</html>
